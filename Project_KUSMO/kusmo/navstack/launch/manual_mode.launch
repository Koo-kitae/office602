<launch>
    <node pkg="tf" type="static_transform_publisher" name="base_link_to_laser" args="-0.114 0 0.242 0 0 0 base_link laser 10"/>
    <node pkg="tf" type="static_transform_publisher" name="base_link_broadcaster" args="0 0 0.0535 0 0 0 base_footprint base_link 10"/>

    <param name="m_bSingle_TF_option" type="bool" value="true"/>
    <node pkg="iahrs_driver" type="iahrs_driver" name="iahrs_driver" output="screen"/>

    <node name="ydlidar_lidar_publisher"  pkg="ydlidar_ros_driver"  type="ydlidar_ros_driver_node" output="screen" respawn="false" >
        <param name="port"         type="string" value="/dev/ttyUSB2"/>  
        <param name="frame_id"     type="string" value="laser"/>
        <param name="baudrate"     type="int"    value="128000"/>
        <param name="reversion"    type="bool"   value="true"/>
        <param name="angle_min"    type="double" value="-180" />
        <param name="angle_max"    type="double" value="180" />
        <param name="range_min"    type="double" value="0.1" />
        <param name="range_max"    type="double" value="12.0" />
    </node>

    <node pkg="md" type="md_robot_node" name="md_robot_node" output="screen">
        <remap from="/cmd_vel_mux/input/navi" to="/cmd_vel" />
        
        <param name = "use_MDUI"                    value = "0"/>       <!-- 0: not use MDUI, 1: use MDUI -->
        <param name = "serial_port"                 value = "ttyUSB0"/> <!-- COM port -->
        <param name = "serial_baudrate"             value = "19200"/>   <!-- Motor controller baudrate -->
        <param name = "wheel_radius"                value = "0.054"/> <!-- unit: meter -->
        <param name = "wheel_length"                value = "0.342"/>  <!-- unit: meter -->
        <param name = "reduction"                   value = "30"/>
        <param name = "reverse_direction"           value = "0"/>       <!-- 0: forward, 1: reverse -->
        <param name = "maxrpm"                      value = "1024"/>    <!-- unit: RPM -->
        <param name = "enable_encoder"              value = "0"/>      <!-- 0: hall sensor, 1: encoder, Use the encoder only when using an in-wheel motor -->
        <param name = "encoder_PPR"                 value = "900"/>    <!-- if use encoder position, encoder PPR, reference PID 126(PID_PPR) -->
        <param name = "slow_start"                  value = "300"/>     <!-- unit: RPM -->
        <param name = "slow_down"                   value = "300"/>     <!-- unit: RPM -->
    </node>

    <node pkg="localization_data" type="ekf_odom_pub" name="ekf_odom_pub">
        <remap from="right_ticks" to="/right_motor_speed"/>
        <remap from="left_ticks" to="/left_motor_speed"/>
    </node>

    <remap from="odom" to="odom_data_quat"/>
    <remap from="imu_data" to="imu/data"/>
    <node pkg="robot_pose_ekf" type="robot_pose_ekf" name="robot_pose_ekf">
        <param name="output_frame" value="odom"/>
        <param name="base_footprint_frame" value="base_footprint"/>
        <param name="freq" value="30.0"/>
        <param name="sensor_timeout" value="1.0"/>
        <param name="odom_used" value="true"/>
        <param name="imu_used" value="true"/>
        <param name="vo_used" value="false"/>
    </node>
</launch>